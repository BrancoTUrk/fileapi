<!DOCTYPE html>
<html lang="en">
<head>
<meta charset=utf-8>
<meta name="viewport" content="width=620">
<title>File API</title>
<body>
<section id="wrapper">
    <header>
      <h1>File API</h1>
    </header>

<style>
#holder { border: 10px dashed #ccc; width: 200px; height: 200px; }
#holder.hover { border: 10px dashed #333; }
</style>
<article>
  <div id="holder" style="position: block;" ></div> 
  <div><textarea id="exampleTextarea" rows="8"></textarea></div>
  <div><button id="downloadBtn">Download</button></div>
</article>


<script>	//drag and drop script
var holder = document.getElementById('holder');
 
holder.ondragover = function () { this.className = 'hover'; return false; };
holder.ondragend = function () { this.className = ''; return false; };
holder.ondrop = function (e) {

  this.className = '';
  e.preventDefault();

  var file = e.dataTransfer.files[0],
      reader = new FileReader();
  	reader.onload = function (event) {
    console.log(event.target);

	document.getElementById('exampleTextarea').value = event.target.result;
  };
  reader.readAsText(file, 'UTF-8');
  console.log(file);
  reader.readAsDataURL(file);

  return false;
};

//download button
document.getElementById('downloadBtn').onclick = function() {
  if ('Blob' in window) {
    var fileName = 'Untitled.txt';
    if (fileName) {
      var textToWrite = document.getElementById('exampleTextarea').value.replace(/\n/g, '\r\n');
      var textFileAsBlob = new Blob([textToWrite], { type: 'text/plain' });

      if ('msSaveOrOpenBlob' in navigator) {
        navigator.msSaveOrOpenBlob(textFileAsBlob, fileName);
      } else {
        var downloadLink = document.createElement('a');
        downloadLink.download = fileName;
        downloadLink.innerHTML = 'Download File';
        if ('webkitURL' in window) {
          // Chrome allows the link to be clicked without actually adding it to the DOM.
          downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
        } else {
          // Firefox requires the link to be added to the DOM before it can be clicked.
          downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
          downloadLink.onclick = destroyClickedElement;
          downloadLink.style.display = 'none';
          document.body.appendChild(downloadLink);
        }

        downloadLink.click();
      }
    }
  } else {
    alert('Your browser does not support the HTML5 Blob.');
  }
};

function destroyClickedElement(event) {
  document.body.removeChild(event.target);
}
</script>


</section>
</body>
</html>